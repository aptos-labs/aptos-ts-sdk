// Copyright Â© Aptos Foundation
// SPDX-License-Identifier: Apache-2.0

import {
  Account,
  Aptos,
  UserTransactionResponse,
  TypeTag,
  EntryFunctionArgumentTypes,
  HexInput,
  InputGenerateTransactionData,
  InputViewFunctionData,
  SimpleEntryFunctionArgumentTypes,
  MoveVector,
  AnyRawTransaction,
  isUserTransactionResponse,
  Ed25519PrivateKey,
  EphemeralKeyPair,
  generateTransactionPayload,
  InputEntryFunctionData,
} from "../../../src";
import { FUND_AMOUNT, TRANSFER_AMOUNT } from "../../unit/helper";
import { getAptosClient } from "../helper";

export const EPHEMERAL_KEY_PAIR = new EphemeralKeyPair({
  privateKey: new Ed25519PrivateKey("ed25519-priv-0x1111111111111111111111111111111111111111111111111111111111111111"),
  expiryDateSecs: 9876543210, // Expires Friday, December 22, 2282 8:13:30 PM GMT
  blinder: new Uint8Array(31),
});

export async function publishPackage(
  aptos: Aptos,
  senderAccount: Account,
  metadataBytes: HexInput,
  codeBytes: Array<HexInput>,
) {
  const rawTransaction = await aptos.publishPackageTransaction({
    account: senderAccount.accountAddress,
    metadataBytes,
    moduleBytecode: codeBytes,
  });
  const signedTxn = await aptos.transaction.sign({
    signer: senderAccount,
    transaction: rawTransaction,
  });
  const txnHash = await aptos.transaction.submit.simple({
    transaction: rawTransaction,
    senderAuthenticator: signedTxn,
  });

  const response = await aptos.waitForTransaction({
    transactionHash: txnHash.hash,
  });

  if (!isUserTransactionResponse(response)) {
    throw new Error("Expected user transaction response");
  }

  return response;
}

// Instead of funding each account individually, we fund one twice, then send coins from it to the rest
// This results in 2 fund requests and 1 transaction instead of N fund requests. For running tests,
// this saves 10-15 seconds each run.
export async function fundAccounts(aptos: Aptos, accounts: Array<Account>) {
  // Fund first account
  const firstAccount = accounts[0];
  // Fund the first account twice to make sure it has enough coins to send to the rest
  await aptos.fundAccount({ accountAddress: firstAccount.accountAddress, amount: FUND_AMOUNT });
  await aptos.fundAccount({ accountAddress: firstAccount.accountAddress, amount: FUND_AMOUNT });
  // Get the addresses for `accounts[1..n]`
  const addressesRemaining = accounts.slice(1).map((account) => account.accountAddress);
  const amountToSend = Math.floor((FUND_AMOUNT * 2) / accounts.length);
  // Send coins from `account[0]` to `account[1..n]`
  const transaction = await aptos.transaction.build.simple({
    sender: firstAccount.accountAddress,
    data: {
      function: "0x1::aptos_account::batch_transfer",
      functionArguments: [
        new MoveVector(addressesRemaining),
        MoveVector.U64(addressesRemaining.map(() => amountToSend)),
      ],
    },
  });
  const signedTxn = await aptos.transaction.sign({
    signer: firstAccount,
    transaction,
  });
  const transactionResponse = await aptos.transaction.submit.simple({
    transaction,
    senderAuthenticator: signedTxn,
  });
  const response = await aptos.waitForTransaction({
    transactionHash: transactionResponse.hash,
  });
  if (!isUserTransactionResponse(response)) {
    throw new Error("Expected user transaction response");
  }
  return response;
}

export async function createAndFundMultisigAccount(owner: Account) {
  const { aptos } = getAptosClient();
  const payload: InputViewFunctionData = {
    function: "0x1::multisig_account::get_next_multisig_account_address",
    functionArguments: [owner.accountAddress.toString()],
  };
  const [multisigAddress] = await aptos.view<[string]>({ payload });
  const createMultisig = await aptos.transaction.build.simple({
    sender: owner.accountAddress,
    data: {
      function: "0x1::multisig_account::create",
      functionArguments: [1, [], []],
    },
  });
  const ownerAuthenticator = aptos.transaction.sign({ signer: owner, transaction: createMultisig });
  const res = await aptos.transaction.submit.simple({
    senderAuthenticator: ownerAuthenticator,
    transaction: createMultisig,
  });
  await aptos.waitForTransaction({ transactionHash: res.hash });
  await aptos.fundAccount({ accountAddress: multisigAddress, amount: FUND_AMOUNT });
  return multisigAddress;
}

export async function createMultisigTransaction(
  owner: Account,
  multisigAddress: string,
  multisigEntryFunction: InputEntryFunctionData,
) {
  const { aptos, config } = getAptosClient();
  const transactionPayload = await generateTransactionPayload({
    multisigAddress,
    function: multisigEntryFunction.function,
    functionArguments: multisigEntryFunction.functionArguments,
    aptosConfig: config,
  });
  const createMultisigTx = await aptos.transaction.build.simple({
    sender: owner.accountAddress,
    data: {
      function: "0x1::multisig_account::create_transaction",
      functionArguments: [multisigAddress, transactionPayload.multiSig.transaction_payload!.bcsToBytes()],
    },
  });

  const createMultisigTxAuthenticator = aptos.transaction.sign({ signer: owner, transaction: createMultisigTx });

  const createMultisigTxResponse = await aptos.transaction.submit.simple({
    senderAuthenticator: createMultisigTxAuthenticator,
    transaction: createMultisigTx,
  });
  await aptos.waitForTransaction({ transactionHash: createMultisigTxResponse.hash });
}

export async function simpleCoinTransactionHeler(aptos: Aptos, sender: Account, recipient: Account) {
  const senderFundTxn = await aptos.fundAccount({
    accountAddress: sender.accountAddress,
    amount: FUND_AMOUNT,
  });
  const recipientFundTxn = await aptos.fundAccount({
    accountAddress: recipient.accountAddress,
    amount: FUND_AMOUNT,
  });

  const senderOldBalance = await aptos.getAccountAPTAmount({
    accountAddress: sender.accountAddress,
    minimumLedgerVersion: Number(senderFundTxn.version),
  });
  const recipientOldBalance = await aptos.getAccountAPTAmount({
    accountAddress: recipient.accountAddress,
    minimumLedgerVersion: Number(recipientFundTxn.version),
  });

  const transaction = await aptos.transferCoinTransaction({
    sender: sender.accountAddress,
    recipient: recipient.accountAddress,
    amount: TRANSFER_AMOUNT,
  });

  const pendingTxn = await aptos.signAndSubmitTransaction({ signer: sender, transaction });
  const committedTxn = await aptos.waitForTransaction({ transactionHash: pendingTxn.hash });
  const version = Number(committedTxn.version);

  const senderNewBalance = await aptos.getAccountAPTAmount({
    accountAddress: sender.accountAddress,
    minimumLedgerVersion: version,
  });
  const recipientNewBalance = await aptos.getAccountAPTAmount({
    accountAddress: recipient.accountAddress,
    minimumLedgerVersion: version,
  });

  expect(senderOldBalance - senderNewBalance).toBeGreaterThan(TRANSFER_AMOUNT);
  expect(recipientNewBalance - recipientOldBalance).toEqual(TRANSFER_AMOUNT);
}

// Transaction builder helpers
// single signer
export async function rawTransactionHelper(
  aptos: Aptos,
  senderAccount: Account,
  functionName: string,
  typeArgs: TypeTag[],
  args: Array<EntryFunctionArgumentTypes | SimpleEntryFunctionArgumentTypes>,
): Promise<UserTransactionResponse> {
  const rawTransaction = await aptos.transaction.build.simple({
    sender: senderAccount.accountAddress,
    data: {
      function: `${senderAccount.accountAddress}::tx_args_module::${functionName}`,
      typeArguments: typeArgs,
      functionArguments: args,
    },
  });
  const senderAuthenticator = await aptos.transaction.sign({
    signer: senderAccount,
    transaction: rawTransaction,
  });
  const transactionResponse = await aptos.transaction.submit.simple({
    transaction: rawTransaction,
    senderAuthenticator,
  });
  const response = await aptos.waitForTransaction({
    transactionHash: transactionResponse.hash,
  });
  if (!isUserTransactionResponse(response)) {
    throw new Error("Expected user transaction response");
  }
  return response;
}

// multi agent/fee payer
export const rawTransactionMultiAgentHelper = async (
  aptos: Aptos,
  senderAccount: Account,
  functionName: string,
  typeArgs: Array<TypeTag>,
  args: Array<EntryFunctionArgumentTypes | SimpleEntryFunctionArgumentTypes>,
  secondarySignerAccounts: Array<Account>,
  feePayerAccount?: Account,
): Promise<UserTransactionResponse> => {
  let transactionData: InputGenerateTransactionData;
  let generatedTransaction: AnyRawTransaction;
  // Fee payer
  if (feePayerAccount) {
    transactionData = {
      sender: senderAccount.accountAddress,
      data: {
        function: `${senderAccount.accountAddress}::tx_args_module::${functionName}`,
        typeArguments: typeArgs,
        functionArguments: args,
      },
      secondarySignerAddresses: secondarySignerAccounts?.map((account) => account.accountAddress.data),
      withFeePayer: true,
    };
    generatedTransaction = await aptos.transaction.build.multiAgent(transactionData);
  } else if (secondarySignerAccounts) {
    transactionData = {
      sender: senderAccount.accountAddress,
      data: {
        function: `${senderAccount.accountAddress}::tx_args_module::${functionName}`,
        typeArguments: typeArgs,
        functionArguments: args,
      },
      secondarySignerAddresses: secondarySignerAccounts?.map((account) => account.accountAddress.data),
    };
    generatedTransaction = await aptos.transaction.build.multiAgent(transactionData);
  } else {
    transactionData = {
      sender: senderAccount.accountAddress,
      data: {
        function: `${senderAccount.accountAddress}::tx_args_module::${functionName}`,
        typeArguments: typeArgs,
        functionArguments: args,
      },
    };
    generatedTransaction = await aptos.transaction.build.simple(transactionData);
  }

  const senderAuthenticator = aptos.transaction.sign({
    signer: senderAccount,
    transaction: generatedTransaction,
  });

  const secondaryAuthenticators = secondarySignerAccounts.map((account) =>
    aptos.transaction.sign({
      signer: account,
      transaction: generatedTransaction,
    }),
  );

  let feePayerAuthenticator;
  let transactionResponse;
  if (feePayerAccount !== undefined) {
    feePayerAuthenticator = aptos.transaction.signAsFeePayer({
      signer: feePayerAccount,
      transaction: generatedTransaction,
    });
    transactionResponse = await aptos.transaction.submit.multiAgent({
      transaction: generatedTransaction,
      senderAuthenticator,
      additionalSignersAuthenticators: secondaryAuthenticators,
      feePayerAuthenticator,
    });
  } else {
    transactionResponse = await aptos.transaction.submit.multiAgent({
      transaction: generatedTransaction,
      senderAuthenticator,
      additionalSignersAuthenticators: secondaryAuthenticators,
    });
  }

  const response = await aptos.waitForTransaction({
    transactionHash: transactionResponse.hash,
  });
  if (!isUserTransactionResponse(response)) {
    throw new Error("Expected user transaction response");
  }
  return response;
};

export const PUBLISHER_ACCOUNT_PK = "ed25519-priv-0xc694948143dea59c195a4918d7fe06c2329624318a073b95f6078ce54940dae9";
export const PUBLISHER_ACCOUNT_ADDRESS = "2cca48b8b0d7f77ef28bfd608883c599680c5b8db8192c5e3baaae1aee45114c";

// script function byte code form `transfer/sources/script_coin_transfer.move`
export const TYPED_SCRIPT_TEST =
  // eslint-disable-next-line max-len
  "a11ceb0b060000000701000202020603080c04140405181a07321b084d2000000001040100010002030101000003040501000002010203060c0305010b0001090001090002060c0302050b000109000004636f696e04436f696e087769746864726177076465706f736974000000000000000000000000000000000000000000000000000000000000000101000001080b000b0138000c030b020b03380102";

// script function byte code from `arguments/sources/script.move` for the transaction_arguments.test.ts script function tests
export const MULTI_SIGNER_SCRIPT_ARGUMENT_TEST =
  // eslint-disable-next-line max-len
  `a11ceb0b060000000601000802080e03160a05203907596408bd0140000000010002010302040700000507010001030608000107020300030804010015060c060c060c060c060c050505050501020d0e03040f0508000b010108020a020001060c01050b01020d0e03040f0508000b010108020a02066f626a656374067369676e657206737472696e670e74785f617267735f6d6f64756c6506537472696e67064f626a6563740d456d7074795265736f757263650a616464726573735f6f66186173736572745f76616c7565735f666f725f7363726970740000000000000000000000000000000000000000000000000000000000000001${PUBLISHER_ACCOUNT_ADDRESS}000001490b0011000b0521040605100b04010b03010b02010b0101066400000000000000270b0111000b06210416051e0b04010b03010b0201066500000000000000270b0211000b07210424052a0b04010b0301066600000000000000270b0311000b0821043005340b0401066700000000000000270b0411000b0921043a053c066800000000000000270b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b14110102${PUBLISHER_ACCOUNT_ADDRESS}000001490b0011000b0521040605100b04010b03010b02010b0101066400000000000000270b0111000b06210416051e0b04010b03010b0201066500000000000000270b0211000b07210424052a0b04010b0301066600000000000000270b0311000b0821043005340b0401066700000000000000270b0411000b0921043a053c066800000000000000270b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b14110102${PUBLISHER_ACCOUNT_ADDRESS}000001150b0011000b012104060508066400000000000000270b020b030b040b050b060b070b080b090b0a0b0b0b0c110102`;

// hard-coded bytecode for the contract, so we don't have to recompile it every time in ci
export const ARGUMENT_TESTS_CONTRACT_METADATA =
  // eslint-disable-next-line max-len
  "0x25417267756d656e7420546573747320666f722074686520547970657363726970742053444b0100000000000000004038343738303244363644463439354331394633323644334437424243343745323835384438324431394346324132313641424134383339463237453738354634a4021f8b08000000000002ffb590b14ec3301086773f859599b649dbb42e52874a888581816e5585cee7731b4aecc8e70610e2ddb1495958982a2ff6e9fffdd9dfae033cc181f6c2414b722d8b4d389c5b72516e89234beb838c4792db8f8e1843d345f974f750889e0237dee546394eab106267a82367c86143bc179b2e7abe0fe9da371f4e29f8290f4dcc85638c1ddf4e26e9783ceb31fa7602393c7a05cd97adfd2d8e53aab89181fa5c6da1718ef280cfda3421cffe148aaf01bdf527728ffa85307de3daf49861233fd0d20bc40e8c09c49c4dc4008e0163f2f50c17bdfc63ee7d8a0873a5952ecdd22e9764a74a5bb328955233ac57ab852ab1d6ca6855ada658d34c0300554034afab6a8e83f67ef41f6d9d589ac822582ac43749718eb1f6010000010e74785f617267735f6d6f64756c650000000400000000000000000000000000000000000000000000000000000000000000010e4170746f734672616d65776f726b00000000000000000000000000000000000000000000000000000000000000010b4170746f735374646c696200000000000000000000000000000000000000000000000000000000000000010a4d6f76655374646c69620000000000000000000000000000000000000000000000000000000000000004114170746f73546f6b656e4f626a6563747300";
export const ARGUMENT_TESTS_CONTRACT_BYTECODE =
  // eslint-disable-next-line max-len
  "0xa11ceb0b0700000a0c01001002101c032cdd01048902fc01058504ff0907840ef70408fb124006bb13b40710ef1a98020a871d1a0ca11db12f0dd24c06000001010102010301040105010601070008080000090800050a0700020b07010001030d0701000002280200000c00010001000e02010001000f01030001001001040001001101050001001206010001001307010001001408010001001507010001001608010001001701011f0000000000000000000000000000000000000000000000000000000000000001001809010502020202080100190a0a0001051e0c0d0001011f0f0f000103201112010001072115010100010322161701000103231617010001032416180100010325191701000103261a1101000102271d1e0108010429061e0001022a1e220001022b23240001022c2325010801032d0112010001062e010d0100010f03100c10031013110312031303140315031014161c1a1c10211b0e110e120e130e140e0f1711171217131714170f0e0f2711271227132714270f2811281228132814280f0f110f120f130f140f0f2911291229132914290f2a112a122a132a142a0f1e111e121e131e141e0f0d110d120d130d140d0f2111211221132114211c111c171c2c1c0e1c2d1c271c2e1c281c2f1c0f1c301c291c311c2a1c321c1e1c331c0d1c341c211c351c361c371c0c1c381c391c3a1c3b1c3c1c3d1c3e1c3f1c401c411c421c431c441c031c451c461c471c481c491c4a1c4b1c4c1c4d1c4e1c4f1c501c511c521c531c541c551c561c571c581c591c5a1c5b1c5c0b01020d0e03040f0508020b030108000a0200040a0a020a0a08020a0b04010a08020a0a0b04010a0802010a080203050505030b030108000b030108000b0301080001060c21060c01020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b0301080026060c0c060c0c060c0a0501020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108000509000901090209030b030109042001020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b03010800080103030b0301080003030a020a02010a02010802010201034f01010101030303030b04010a08020b04010a080203030303030303030b04010a08020b04010a08020a0a08020a0b04010a08020a0a0b04010a0802060a0802060a0802030303030303030303030303030b04010a08020b04010a08020b04010a08020b04010a08020a08020a08020a08020a08020b04010a08020a0a020a0a020a0a08020a0a08020a0b04010a08020a0b04010a08020a0a0b04010a08020a0b04010a08020a0b04010a08020a0a0b04010a08020a0a020a0a020a0a08020a0a08020a0b04010a08020a0b04010a08020a0a0b04010a08020a0b04010a08020a0b04010a08020a0a0b04010a08020a0a020a020a0a08020a08020a08020a08020a0a020a020a0a08020a08020a08020a0802010900010b04010900010b04010a0802010a0b04010a080201070a090001060b0401090001010106090002060b0401090006090001070b0401090007070a08020a02030a08020a020a0a020a0a0201080001060b03010900010501060801060805030b030108000c0a0b030108000801010b0301080001080501060805010c010b030109007e0a0b030108000101010101010101010101030303030303030303030303030303030303030303030303030303030303030303060206010602060d060e06030604060f0605060802060b030108000b03010800030303030303030303030303030303030303030303030b030108000b030108000b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b03010800010d010e0104010f0801030303030a050a050a0501090101090201090301090401090501090601090701090801090901090a010a0101090b01090c010a0d01090d010a0e01090e010a0301090f010a04010910010a0f010911010a05010912010913010a0b03010800010914010b040101010915010b040102010916010b04010d010917010b04010e010918010b040103010919010b04010401091a010b04010f01091b010b04010501091c010b0401080201091d010b04010b0301080001091e010a0b04010b030108000e74785f617267735f6d6f64756c65056572726f72066f626a656374066f7074696f6e067369676e657206737472696e6709747970655f696e666f06766563746f720d456d7074795265736f757263650953657475704461746106537472696e67064f626a656374186173736572745f76616c7565735f666f725f736372697074064f7074696f6e11636f6d706c65785f617267756d656e74731a6765745f65787065637465645f766563746f725f737472696e67196765745f746573745f6f626a6563745f616464726573736573106765745f746573745f6f626a656374730b696e69745f6d6f64756c6511707269766174655f617267756d656e747322707269766174655f617267756d656e74735f6d756c7469706c655f7369676e657273107075626c69635f617267756d656e7473217075626c69635f617267756d656e74735f6d756c7469706c655f7369676e65727309747970655f7461677312747970655f746167735f666f725f6172677312766965775f616c6c5f617267756d656e74730b64756d6d795f6669656c640e656d7074795f6f626a6563745f310e656d7074795f6f626a6563745f320e656d7074795f6f626a6563745f3304757466380d696e76616c69645f737461746504736f6d6507726576657273650769735f6e6f6e650769735f736f6d6506626f72726f7708636f6e7461696e7307657874726163740e6f626a6563745f616464726573730e436f6e7374727563746f725265660a616464726573735f6f660d6372656174655f6f626a6563740f67656e65726174655f7369676e65721b6f626a6563745f66726f6d5f636f6e7374727563746f725f726566046e6f6e6509747970655f6e616d652cca48b8b0d7f77ef28bfd608883c599680c5b8db8192c5e3baaae1aee45114c00000000000000000000000000000000000000000000000000000000000000010308d007000000000000030810270000000000000308611e0000000000000308003713000000000005202cca48b8b0d7f77ef28bfd608883c599680c5b8db8192c5e3baaae1aee45114c0101010a02100f65787065637465645f737472696e670410050000000000000000000000000000000d0202000f2006000000000000000000000000000000000000000000000000000000000000000e0403000000030804000000000000000201010a05c1010600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000abc0000000000000000000000000000000000000000000000000000000000000def0000000000000000000000000000000000000000000000000000000000000123000000000000000000000000000000000000000000000000000000000000045600000000000000000000000000000000000000000000000000000000000007890a0104030100010a0a0225060f65787065637465645f737472696e6703616263036465660331323303343536033738390a046106000000000000000000000000000000000100000000000000000000000000000002000000000000000000000000000000fdfffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0a0d0d06000001000200fdfffeffffff0a0fc10106000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000fdfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0a0e1906000000000100000002000000fdfffffffeffffffffffffff0a033106000000000000000001000000000000000200000000000000fdfffffffffffffffeffffffffffffffffffffffffffffff0a020706000102fdfeff030864000000000000000410ffffffffffffffffffffffffffffffff0d02ffff0f20ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0e04ffffffff0308ffffffffffffffff0201ff03082c01000000000000030890010000000000000308f4010000000000000308c8000000000000000a020100126170746f733a3a6d657461646174615f763183020700371300000000000c4552524f525f4f46465345540001000000000000000b45585045435445445f55380002000000000000000c45585045435445445f5531360003000000000000000c45585045435445445f5533320004000000000000000c45585045435445445f5536340005000000000000000d45585045435445445f553132380006000000000000000d45585045435445445f55323536000004106765745f746573745f6f626a6563747301010012766965775f616c6c5f617267756d656e7473010100196765745f746573745f6f626a6563745f6164647265737365730101001a6765745f65787065637465645f766563746f725f737472696e670101000002011a010102031b0b030108001c0b030108001d0b0301080000010001010b810107042b011000140c0e0b00070521040a050c060000000000000000270b01070c2104110513060100000000000000270b020708210418051a060200000000000000270b03070a21041f0521060300000000000000270b04070b2104260528060400000000000000270b05070721042d052f060500000000000000270b0607092104340536060600000000000000270b07070421043b053d060700000000000000270b080706110d2104430545060800000000000000270b090b0e21044a054c060900000000000000270b0a0715060a000000000000000c0d0c120c110e11410e0c100a100e12410e21045b056007160b0d16110e270600000000000000000c0f090c0b0b100c0c0a0b046d0b0f060100000000000000160c0f056f080c0b0a0f0a0c230480010e110a0f420e0e120a0f420e21047c057f0b0d110e270566020100040010b304110211021102400303000000000000000c18110238000c320a320a320b32401303000000000000000c190a190a190a19401403000000000000000c1a0b00071507150715400c03000000000000000600000000000000000c0e0c4d0c470e47410c0e4d410c210422052707160b0e16110e270b470b4d0c3d0c330d3338010d3d38010b330b3d0c3e0c340e34410c0c210a210e3e410c21043c053e060200020000000000270a2106000000000000000024047e05430d34450c0d3e450c0a0e0c0f0c4e0c480e48410e0c260a260e4e410e210454055907160b0f16110e270600000000000000000c1d090c040b260c080a0404660b1d060100000000000000160c1d0568080c040a1d0a082304790e480a1d420e0e4e0a1d420e21047505780b0f110e27055f0b21060100000000000000170c21053e0b34460c00000000000000000b3e460c00000000000000000b010b180601000000000000000c100c4f0c490e4941030e4f410321048f0105940107160b1016110e270b490b4f0c3f0c350d3538020d3f38020b350b3f0c400c360e3641030c220a220e4041032104a90105ab01060200020000000000270a220600000000000000002404eb0105b0010d3645030d4045030a100c110c500c4a0e4a410d0c270a270e50410d2104c10105c60107160b1116110e270600000000000000000c1e090c050b270c090a0504d3010b1e060100000000000000160c1e05d501080c050a1e0a092304e6010e4a0a1e420d0e500a1e420d2104e20105e5010b11110e2705cc010b22060100000000000000170c2205ab010b36460300000000000000000b40460300000000000000000b020b190c410c370d3738030d4138030b370b410c420c380e3841130c230a230e42411321048402058602060200020000000000270a230600000000000000002404f902058b020d3845130d4245130c160c0c0a0c0a160602000000000000000c120c2c0c2a0e2a380404a4020e2c3804049e0205a302071d0b1216110e2705ba020e2c380504a80205ad02071e0b1216110e270e2a38060c1b0e2c0b1b380704b50205ba02071f0b1216110e270d0c38080c2e0d1638080c300b2e0b300602000000000000000c130c510c4b0e4b410d0c280a280e51410d2104cf0205d40207160b1316110e270600000000000000000c1f090c060b280c0a0a0604e1020b1f060100000000000000160c1f05e302080c060a1f0a0a2304f4020e4b0a1f420d0e510a1f420d2104f00205f3020b13110e2705da020b23060100000000000000170c230586020b38461300000000000000000b42461300000000000000000b030b1a0c430c390d3938090d4338090b390b430c460c3c0e3c41140c250a250e46411421049203059403060200020000000000270a250600000000000000002404ae040599030d3c45140d4645140c440c3a0d3a38030d4438030b3a0b440c450c3b0e3b41130c240a240e4541132104b00305b203060200020000000000270a240600000000000000002404a50405b7030d3b45130d4545130c170c0d0a0d0a170603000000000000000c140c2d0c2b0e2b380404d0030e2d380404ca0305cf03071d0b1416110e2705e6030e2d380504d40305d903071e0b1416110e270e2b38060c1c0e2d0b1c380704e10305e603071f0b1416110e270d0d38080c2f0d1738080c310b2f0b310603000000000000000c150c520c4c0e4c410d0c290a290e52410d2104fb0305800407160b1516110e270600000000000000000c20090c070b290c0b0a07048d040b20060100000000000000160c20058f04080c070a200a0b2304a0040e4c0a20420d0e520a20420d21049c04059f040b15110e270586040b24060100000000000000170c2405b2030b3b461300000000000000000b45461300000000000000000b25060100000000000000170c250594030b3c461400000000000000000b464614000000000000000002020100001b24400d00000000000000000c03070f0c050d0538010b050c060e06410c0c020a0206000000000000000024042005100d06450c0c010d030c000b010c040b000b04110d440d0b02060100000000000000170c02050b0b06460c00000000000000000b03020301000101050b11040c020c010c000e00380a0e01380a0e02380a0204010001011f0d07042b010c000a001000140a001001140b00100214020500000020360a0011170704210406050a0b0001070227402100000000000000000c050600000000000000000c020a020603000000000000002304280513070411180c010e0111190c040e040912002d000e01380b0c030d050b0344210b02060100000000000000160c02050e0d05380c0d0545210d0545210d05452112010c060b000b062d0102060004010101230b000b010b020b030b040b050b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0b20110802070004010101280b000b010b020b030b040b050b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0b200b210b220b230b240b25110902080104010126a00907042b011000140c590b01070521040a050e070106000000000000000016270b02070c2104130517070106010000000000000016270b03070821041c0520070106020000000000000016270b04070a2104250529070106030000000000000016270b05070b21042e0532070106040000000000000016270b060707210437053b070106050000000000000016270b0707092104400544070106060000000000000016270b080704210449054d070106070000000000000016270b090706110d2104530557070106080000000000000016270b0a0a5921045c0560070106090000000000000016270b0b07210701060a00000000000000160c380c94010c89010e8901410e0c650a650e9401410e210471057607160b3816110e270600000000000000000c5a090c220b650c2d0a220483010b5a060100000000000000160c5a058501080c220a5a0a2d230496010e89010a5a420e0e94010a5a420e210492010595010b38110e27057c0b0c070e0701060b00000000000000160c390c95010c8a010e8a0141170c660a660e950141172104a70105ac0107160b3916110e270600000000000000000c5b090c230b660c2e0a2304b9010b5b060100000000000000160c5b05bb01080c230a5b0a2e2304cc010e8a010a5b42170e95010a5b42172104c80105cb010b39110e2705b2010b0d07150701060c00000000000000160c3a0c96010c8b010e8b01410e0c670a670e9601410e2104dd0105e20107160b3a16110e270600000000000000000c5c090c240b670c2f0a2404ef010b5c060100000000000000160c5c05f101080c240a5c0a2f230482020e8b010a5c420e0e96010a5c420e2104fe010581020b3a110e2705e8010b0e07110701060d00000000000000160c3b0c97010c8c010e8c0141270c680a680e970141272104930205980207160b3b16110e270600000000000000000c5d090c250b680c300a2504a5020b5d060100000000000000160c5d05a702080c250a5d0a302304b8020e8c010a5d42270e97010a5d42272104b40205b7020b3b110e27059e020b0f07130701060e00000000000000160c3c0c98010c8d010e8d0141280c690a690e980141282104c90205ce0207160b3c16110e270600000000000000000c5e090c260b690c310a2604db020b5e060100000000000000160c5e05dd02080c260a5e0a312304ee020e8d010a5e42280e98010a5e42282104ea0205ed020b3c110e2705d4020b1007140701060f00000000000000160c3d0c99010c8e010e8e01410f0c6a0a6a0e9901410f2104ff0205840307160b3d16110e270600000000000000000c5f090c270b6a0c320a270491030b5f060100000000000000160c5f059303080c270a5f0a322304a4030e8e010a5f420f0e99010a5f420f2104a00305a3030b3d110e27058a030b1107100701061000000000000000160c3e0c9a010c8f010e8f0141290c6b0a6b0e9a0141292104b50305ba0307160b3e16110e270600000000000000000c60090c280b6b0c330a2804c7030b60060100000000000000160c6005c903080c280a600a332304da030e8f010a6042290e9a010a6042292104d60305d9030b3e110e2705c0030b1207120701061100000000000000160c3f0c9b010c90010e9001412a0c6c0a6c0e9b01412a2104eb0305f00307160b3f16110e270600000000000000000c61090c290b6c0c340a2904fd030b61060100000000000000160c6105ff03080c290a610a34230490040e90010a61422a0e9b010a61422a21048c04058f040b3f110e2705f6030b13070d0701061200000000000000160c400c9c010c91010e9101411e0c6d0a6d0e9c01411e2104a10405a60407160b4016110e270600000000000000000c62090c2a0b6d0c350a2a04b3040b62060100000000000000160c6205b504080c2a0a620a352304c6040e91010a62421e0e9c010a62421e2104c20405c5040b40110e2705ac040b1411020701061300000000000000160c410c9d010c92010e9201410d0c6e0a6e0e9d01410d2104d70405dc0407160b4116110e270600000000000000000c63090c2b0b6e0c360a2b04e9040b63060100000000000000160c6305eb04080c2b0a630a362304fc040e92010a63420d0e9d010a63420d2104f80405fb040b41110e2705e2040b150c2111040c720c710c700b210b700b710b72402103000000000000000701061400000000000000160c420c9e010c93010e930141210c6f0a6f0e9e01412121049605059b0507160b4216110e270600000000000000000c64090c2c0b6f0c370a2c04a8050b64060100000000000000160c6405aa05080c2c0a640a372304bb050e93010a6442210e9e010a6442212104b70505ba050b42110e2705a1050b16380d0701061500000000000000160c430c7e0c730e73380e04d0050e7e380e04ca0505cf05071d0b4316110e2705e6050e7e380f04d40505d905071e0b4316110e270e7338100c4e0e7e0b4e381104e10505e605071f0b4316110e270b17070538120701061600000000000000160c440c7f0c740e74381304fc050e7f381304f60505fb05071d0b4416110e270592060e7f3814048006058506071e0b4416110e270e7438150c4f0e7f0b4f3816048d06059206071f0b4416110e270b18070c38170701061700000000000000160c450c80010c750e75380e04a8060e8001380e04a20605a706071d0b4516110e2705be060e8001380f04ac0605b106071e0b4516110e270e7538100c500e80010b50381104b90605be06071f0b4516110e270b19070838180701061800000000000000160c460c81010c760e76381904d4060e8101381904ce0605d306071d0b4616110e2705ea060e8101381a04d80605dd06071e0b4616110e270e76381b0c510e81010b51381c04e50605ea06071f0b4616110e270b1a070a381d0701061900000000000000160c470c82010c770e77381e0480070e8201381e04fa0605ff06071d0b4716110e270596070e8201381f048407058907071e0b4716110e270e7738200c520e82010b523821049107059607071f0b4716110e270b1b070b38220701061a00000000000000160c480c83010c780e78382304ac070e8301382304a60705ab07071d0b4816110e2705c2070e8301382404b00705b507071e0b4816110e270e7838250c530e83010b53382604bd0705c207071f0b4816110e270b1c070738270701061b00000000000000160c490c84010c790e79382804d8070e8401382804d20705d707071d0b4916110e2705ee070e8401382904dc0705e107071e0b4916110e270e79382a0c540e84010b54382b04e90705ee07071f0b4916110e270b1d0709382c0701061c00000000000000160c4a0c85010c7a0e7a382d0484080e8501382d04fe07058308071d0b4a16110e27059a080e8501382e048808058d08071e0b4a16110e270e7a382f0c550e85010b553830049508059a08071f0b4a16110e270b1e070438310701061d00000000000000160c4b0c86010c7b0e7b383204b0080e8601383204aa0805af08071d0b4b16110e2705c6080e8601383304b40805b908071e0b4b16110e270e7b38340c560e86010b56383504c10805c608071f0b4b16110e270b1f0706110d38360701061e00000000000000160c4c0c87010c7c0e7c383704dd080e8701383704d70805dc08071d0b4c16110e2705f3080e8701383804e10805e608071e0b4c16110e270e7c38390c570e87010b57383a04ee0805f308071f0b4c16110e270b200b59383b0701061f00000000000000160c4d0c88010c7d0e7d383c0489090e8801383c048309058809071d0b4d16110e27059f090e8801383d048d09059209071e0b4d16110e270e7d383e0c580e88010b58383f049a09059f09071f0b4d16110e270209010401012b670a0011170e0111170b0211170e0311170b041117401e05000000000000000c2b0b050b2b07000c280c2d0c2c0e2c411e0c2a0a2a0e2d411e21041b05220b000107160b2816110e270600000000000000000c29090c260b2a0c270a26042f0b29060100000000000000160c290531080c260a290a272304440e2c0a29421e0e2d0a29421e21043e05430b00010b28110e2705280b000b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0b200b210b220b230b240b251108020a010400019802384038412104050509070306000000000000000016273842384321040e05120703060100000000000000162738443845210417051b070306020000000000000016273846384721042005240703060300000000000000162738483849210429052d07030604000000000000001627384a384b210432053607030605000000000000001627384c384d21043b053f07030606000000000000001627384e384f2104440548070306070000000000000016273850385121044d05510703060800000000000000162738523853210456055a070306090000000000000016273854385521045f05630703060a00000000000000162738563857210468056c0703060b0000000000000016273858385921047105750703060c000000000000001627385a385b21047a057e0703060d000000000000001627385c385d210483010587010703060e000000000000001627385e385f21048c010590010703060f0000000000000016273860386121049501059901070306100000000000000016273862386321049e0105a20107030611000000000000001627386438652104a70105ab0107030612000000000000001627386638672104b00105b40107030613000000000000001627386838692104b90105bd0107030614000000000000001627386a386b2104c20105c60107030615000000000000001627386c386d2104cb0105cf0107030616000000000000001627386e386f2104d40105d80107030617000000000000001627387038712104dd0105e10107030618000000000000001627387238732104e60105ea0107030619000000000000001627387438752104ef0105f3010703061a000000000000001627387638772104f80105fc010703061b00000000000000162738783879210481020585020703061c000000000000001627387a387b21048a02058e020703061d000000000000001627387c387d210493020597020703061e000000000000001627020b0104000101020c01000001210b000b010b020b030b040b050b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0201000101010200";

export async function publishArgumentTestModule(
  aptos: Aptos,
  senderAccount: Account,
): Promise<UserTransactionResponse> {
  const response = await publishPackage(aptos, senderAccount, ARGUMENT_TESTS_CONTRACT_METADATA, [
    ARGUMENT_TESTS_CONTRACT_BYTECODE,
  ]);
  return response;
}

export const singleSignerScriptBytecode =
  // eslint-disable-next-line max-len
  "a11ceb0b060000000701000402040a030e0c041a04051e20073e30086e2000000001010204010001000308000104030401000105050601000002010203060c0305010b0001080101080102060c03010b0001090002050b00010900000a6170746f735f636f696e04636f696e04436f696e094170746f73436f696e087769746864726177076465706f7369740000000000000000000000000000000000000000000000000000000000000001000001080b000b0138000c030b020b03380102";

export const multiSignerScriptBytecode =
  // eslint-disable-next-line max-len
  "a11ceb0b060000000701000402040a030e18042608052e4307713e08af01200000000101020401000100030800010403040100010505060100010607040100010708060100000201020202030207060c060c0303050503030b000108010b000108010b0001080101080102060c03010b0001090002070b000109000b000109000002070b000109000302050b000109000a6170746f735f636f696e04636f696e04436f696e094170746f73436f696e087769746864726177056d657267650765787472616374076465706f73697400000000000000000000000000000000000000000000000000000000000000010000011a0b000a0238000c070b010a0338000c080d070b0838010d070b020b03160b061738020c090b040b0738030b050b09380302";

export async function publishTransferPackage(aptos: Aptos, senderAccount: Account) {
  await publishPackage(
    aptos,
    senderAccount,
    // eslint-disable-next-line max-len
    "107472616e73616374696f6e5f746573740100000000000000004035364643333939394442364244363842383430304539323438363839393837413338313439344644413241343631334144373946333630323134353539324545ba011f8b08000000000002ff5d8f3d0ec2300c85779f0265e944032b12030b97a8aaca4d4c1b95fc284e0bc72729a503f2e2a7f7d97e6e02aa09076ac1a1a5c3f5205244c7a892f1ae4bc449c04291b32ae6a9ce25001a4d819c26a70c717d0bc9f33de6052f1fa7160693325c8d2905be4899e538f7b5f25662218f4fec796b958f5467a082484b19b2685c053cf7dac4a2bf98f50bc9c7efc236bbeb2a0742ad233113b7b0baddeeaeb9df6701ff9f15a3131fec1509190201000001087472616e73666572ca021f8b08000000000002ff9552cb4ec33010bcf72bf654a522dc10071790101f12b9f1a6582476e407a142fd77fc48d23826125891627b661fb39e4e32db22184585a6b5e1525406b52124dc34a8e07b07e03eab11686fa4ae1a453b1ca4fa20245ed4928be33629c03b87f6f6d4f21a50187581c60a3083ac4e97cafd0a07c7d570e5cac35ef3b34055cef71a6b29d82f00eda415a61ae3ece343064da109c6f41c431953a8758a4d413988bdd43c2f780893f2ab45035e74a4c07338103270f3ce141d9e6e5323e4d5efdfdcf6a508ec32d17338ae53c6b6fe9c33d2cb741287f01a7e457e87ea8cc5beb3cbb6cb65bd5bc45623f8e50c539b3ccb520edca58dc07d3acd75632358cc6f552e52cfb3c9b993ea5481e75e6381dc89a3db8b85df0443b5e9b7959b14d61c3f3d3ff14bee897fbc9caf3fcd6f43ec54364a9d355e7f00fb8d2dcfd603000000000300000000000000000000000000000000000000000000000000000000000000010e4170746f734672616d65776f726b00000000000000000000000000000000000000000000000000000000000000010b4170746f735374646c696200000000000000000000000000000000000000000000000000000000000000010a4d6f76655374646c696200",
    [
      // eslint-disable-next-line max-len
      `a11ceb0b060000000801000602060a031022043208053a4e0788015208da01400c9a024c000001010102020404010001010508000000000100000302010002060506010002070701010002080901010002090a060100020403040404050403060c03050007060c060c0303050503010b0001080101080102060c03010b0001090002050b00010900030b000108010b000108010b0001080102070b000109000b0001090002070b0001090003087472616e736665720a6170746f735f636f696e04636f696e0a74776f5f62795f74776f04436f696e094170746f73436f696e087769746864726177076465706f736974056d657267650765787472616374${senderAccount.accountAddress.toStringWithoutPrefix()}00000000000000000000000000000000000000000000000000000000000000010001040003080b000b0138000c030b020b0338010201010400081a0b000a0238000c070b010a0338000c080d070b0838020d070b020b03160b061738030c090b040b0738010b050b0938010200`,
    ],
  );
}
